#include "ds18b20.h"
#include "UART_for_PC.h"

int __io_putchar(int ch) {
	uint8_t ch8 = ch & 0xFF;
	UART_send_data(ch8);
	return ch;
}

void StartHSE(void);

int main() {
	//StartHSE();
	init_USART();
	init_DS18B20();
	while(1) {
		DS18B20_measure_temperature();
		if(flag)
			printf(" temp: %f C\r\n", (int8_t)(temperature));
	}
}

void StartHSE()
{
	RCC->CR |= RCC_CR_CSSON | RCC_CR_HSEBYP; /* (2) */
	RCC->CR |= RCC_CR_HSEON;
	while((RCC->CR & RCC_CR_HSERDY) != RCC_CR_HSERDY);
	RCC->CFGR = ((RCC->CFGR & (~RCC_CFGR_SW)) | RCC_CFGR_SW_0);
}
